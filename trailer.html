<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4SP Trailer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden; /* Hide scrollbars during animation */
            font-family: 'Geist', sans-serif;
            background-color: #000;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100vw;
        }

        #trailer-container {
            position: relative;
            width: 1920px; /* Reference width for "website" content */
            height: 1080px; /* Reference height for "website" content */
            overflow: hidden;
            background-color: #000;
            transform-origin: center center;
            /* Initial scale to fit screen, will be adjusted by JS */
            transform: scale(0.5); /* Example scale */
        }

        #cursor {
            position: absolute;
            width: 24px;
            height: 24px;
            background-color: white; /* Example cursor */
            border-radius: 50%;
            pointer-events: none; /* Allow clicks to pass through */
            z-index: 10000;
            transition: transform 0.1s ease-out; /* Smooth cursor movement */
            transform: translate(-50%, -50%);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        /* Mockup styles for website elements */
        .mock-page {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #000;
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        .mock-page.active {
            opacity: 1;
        }

        #index-page {
            justify-content: center;
            gap: 20px;
        }

        #dashboard-page {
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: flex-start;
        }

        .mock-navbar {
            width: 100%;
            height: 60px;
            background-color: #1a1a1a;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
            z-index: 10;
        }

        .mock-nav-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .mock-nav-item:hover {
            background-color: #333;
        }

        .mock-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #0070f3; /* Placeholder color */
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .mock-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .mock-dropdown {
            position: absolute;
            top: 55px; /* Adjust based on navbar height */
            right: 0;
            background-color: #1a1a1a;
            border: 1px solid #333;
            border-radius: 5px;
            min-width: 150px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: opacity 0.2s ease-out, transform 0.2s ease-out, visibility 0.2s;
        }
        .mock-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .mock-dropdown-item {
            padding: 10px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
            white-space: nowrap;
        }
        .mock-dropdown-item:hover {
            background-color: #333;
        }

        .mock-sidebar {
            width: 250px;
            height: calc(100% - 60px); /* Full height minus navbar */
            background-color: #1a1a1a;
            padding-top: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.5);
            z-index: 5;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .mock-sidebar-item {
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .mock-sidebar-item:hover {
            background-color: #333;
        }
        .mock-sidebar-item.selected {
            background-color: #0070f3;
        }

        #final-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            z-index: 10001;
        }

        #final-screen h1 {
            font-size: 80px;
            font-weight: bold;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 1s ease-out, transform 1s ease-out;
            text-align: center;
        }
        #final-screen p {
            font-size: 30px;
            color: #aaa;
            margin-top: 20px;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 1s ease-out, transform 1s ease-out;
            text-align: center;
        }

        .gradient-text {
            background-image: linear-gradient(90deg, #0070f3, #f81ce5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .content-area {
            flex-grow: 1;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 50px;
            background-color: #0a0a0a;
        }
        .theme-selector {
            position: absolute;
            top: 100px; /* Just an example position */
            right: 50px;
            background-color: #1a1a1a;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            gap: 10px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .theme-selector.active {
            opacity: 1;
            visibility: visible;
        }
        .theme-option {
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .theme-option:hover {
            background-color: #333;
        }
    </style>
</head>
<body>
    <div id="trailer-container">
        <div id="cursor"></div>

        <!-- Initial Index Page -->
        <div id="index-page" class="mock-page active">
            <h1 class="text-6xl font-bold gradient-text">4SP</h1>
            <p class="text-3xl text-gray-400">The Essential Student Toolkit.</p>
            <button id="get-started-button" class="mt-10 px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white text-2xl rounded-xl shadow-lg transition">
                Get Started Instantly <i class="fas fa-arrow-right ml-3"></i>
            </button>
        </div>

        <!-- Dashboard Page (initially hidden) -->
        <div id="dashboard-page" class="mock-page">
            <div class="mock-navbar">
                <div class="flex items-center gap-5">
                    <span class="text-3xl font-bold gradient-text">4SP</span>
                    <div class="mock-nav-item">Dashboard</div>
                    <div class="mock-nav-item">Soundboard</div>
                </div>
                <div class="relative">
                    <div id="auth-avatar" class="mock-avatar">
                        <img src="mibi-avatars/head.png" alt="Mibi Avatar">
                    </div>
                    <div id="auth-dropdown" class="mock-dropdown">
                        <div class="mock-dropdown-item">Profile</div>
                        <div id="settings-item" class="mock-dropdown-item">Settings</div>
                        <div class="mock-dropdown-item">Logout</div>
                    </div>
                </div>
            </div>
            <div class="mock-sidebar">
                <div class="mock-sidebar-item">Dashboard</div>
                <div class="mock-sidebar-item">Soundboard</div>
                <div class="mock-sidebar-item">Notes</div>
                <div class="mock-sidebar-item">Countdowns</div>
                <div class="mock-sidebar-item">Dictionary</div>
                <div id="personalization-sidebar-item" class="mock-sidebar-item">Personalization</div>
                <div class="mock-sidebar-item">Legal</div>
            </div>
            <div class="content-area">
                <p>Welcome to your Dashboard!</p>
            </div>
            <div id="theme-selector" class="theme-selector">
                <div class="text-lg font-bold mb-2">Select Theme</div>
                <div class="theme-option" data-theme="dark">Dark Theme</div>
                <div class="theme-option" data-theme="light">Light Theme</div>
                <div class="theme-option" data-theme="system">System Default</div>
            </div>
        </div>

        <!-- Final Black Screen -->
        <div id="final-screen">
            <h1 id="final-text-1">Customization. That's 4SP.</h1>
            <p id="final-text-2">v5-4simpleproblems.github.io</p>
        </div>
    </div>

    <script>
        const trailerContainer = document.getElementById('trailer-container');
        const cursor = document.getElementById('cursor');
        const indexPage = document.getElementById('index-page');
        const dashboardPage = document.getElementById('dashboard-page');
        const getStartedButton = document.getElementById('get-started-button');
        const authAvatar = document.getElementById('auth-avatar');
        const authDropdown = document.getElementById('auth-dropdown');
        const settingsItem = document.getElementById('settings-item');
        const sidebarItems = document.querySelectorAll('.mock-sidebar-item');
        const personalizationSidebarItem = document.getElementById('personalization-sidebar-item');
        const themeSelector = document.getElementById('theme-selector');
        const themeOptions = document.querySelectorAll('.theme-option');
        const finalScreen = document.getElementById('final-screen');
        const finalText1 = document.getElementById('final-text-1');
        const finalText2 = document.getElementById('final-text-2');

        const animationSpeed = 1; // Global speed multiplier (1 = normal, 0.5 = half speed, 2 = double speed)

        // Function to move cursor
        function moveCursorTo(element, duration, callback) {
            const rect = element.getBoundingClientRect();
            const containerRect = trailerContainer.getBoundingClientRect();
            const targetX = rect.left + rect.width / 2 - containerRect.left;
            const targetY = rect.top + rect.height / 2 - containerRect.top;

            const currentX = parseFloat(cursor.style.left || '0');
            const currentY = parseFloat(cursor.style.top || '0');

            const start = performance.now();

            function animate(currentTime) {
                const elapsed = currentTime - start;
                const progress = Math.min(elapsed / duration, 1);

                cursor.style.left = currentX + (targetX - currentX) * progress + 'px';
                cursor.style.top = currentY + (targetY - currentY) * progress + 'px';

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    if (callback) callback();
                }
            }
            requestAnimationFrame(animate);
        }

        // Function to set cursor position immediately
        function setCursorPos(element) {
            const rect = element.getBoundingClientRect();
            const containerRect = trailerContainer.getBoundingClientRect();
            cursor.style.left = (rect.left + rect.width / 2 - containerRect.left) + 'px';
            cursor.style.top = (rect.top + rect.height / 2 - containerRect.top) + 'px';
        }

        // Function to set camera (zoom and pan)
        function setCamera(scale, translateX, translateY, duration, callback) {
            const currentTransform = trailerContainer.style.transform;
            const currentScaleMatch = currentTransform.match(/scale\(([^)]+)\)/);
            const currentTranslateXMatch = currentTransform.match(/translateX\(([^)]+)\)/);
            const currentTranslateYMatch = currentTransform.match(/translateY\(([^)]+)\)/);

            const currentScale = currentScaleMatch ? parseFloat(currentScaleMatch[1]) : 1;
            const currentTranslateX = currentTranslateXMatch ? parseFloat(currentTranslateXMatch[1]) : 0;
            const currentTranslateY = currentTranslateYMatch ? parseFloat(currentTranslateYMatch[1]) : 0;

            const start = performance.now();

            function animate(currentTime) {
                const elapsed = currentTime - start;
                const progress = Math.min(elapsed / duration, 1);

                const newScale = currentScale + (scale - currentScale) * progress;
                const newTranslateX = currentTranslateX + (translateX - currentTranslateX) * progress;
                const newTranslateY = currentTranslateY + (translateY - currentTranslateY) * progress;

                trailerContainer.style.transform = `scale(${newScale}) translateX(${newTranslateX}px) translateY(${newTranslateY}px)`;

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    if (callback) callback();
                }
            }
            requestAnimationFrame(animate);
        }

        // Initial setup for trailer container scale
        function fitTrailerToWindow() {
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            const trailerWidth = trailerContainer.offsetWidth;
            const trailerHeight = trailerContainer.offsetHeight;

            const scaleX = windowWidth / trailerWidth;
            const scaleY = windowHeight / trailerHeight;
            const initialScale = Math.min(scaleX, scaleY);

            trailerContainer.style.transform = `scale(${initialScale})`;
            setCursorPos(indexPage.querySelector('h1')); // Set initial cursor position
        }

        window.addEventListener('resize', fitTrailerToWindow);
        fitTrailerToWindow(); // Initial fit

        // Animation sequence
        async function startTrailer() {
            // 0. Initial state: Index page active, cursor on h1
            await new Promise(resolve => setTimeout(resolve, 500 * animationSpeed)); // Wait a bit

            // 1. Move cursor to "Get Started Instantly" button
            await moveCursorTo(getStartedButton, 1500 * animationSpeed);
            getStartedButton.classList.add('bg-blue-700'); // Simulate hover
            await new Promise(resolve => setTimeout(resolve, 500 * animationSpeed));
            getStartedButton.classList.remove('bg-blue-700'); // Simulate click release

            // 2. Transition to Dashboard (simulate redirect)
            indexPage.classList.remove('active');
            dashboardPage.classList.add('active');
            setCursorPos(authAvatar); // Immediately move cursor to a relevant spot on new page
            await new Promise(resolve => setTimeout(resolve, 1000 * animationSpeed));

            // 3. Move cursor to auth avatar and click
            await moveCursorTo(authAvatar, 1000 * animationSpeed);
            authAvatar.style.transform = 'scale(1.1)'; // Simulate hover/click
            await new Promise(resolve => setTimeout(resolve, 200 * animationSpeed));
            authDropdown.classList.add('active'); // Show dropdown
            authAvatar.style.transform = 'scale(1)';
            await new Promise(resolve => setTimeout(resolve, 500 * animationSpeed));

            // 4. Move cursor to Settings item and click
            await moveCursorTo(settingsItem, 700 * animationSpeed);
            settingsItem.style.backgroundColor = '#333'; // Simulate hover
            await new Promise(resolve => setTimeout(resolve, 300 * animationSpeed));
            settingsItem.style.backgroundColor = ''; // Simulate click release
            authDropdown.classList.remove('active'); // Hide dropdown
            await new Promise(resolve => setTimeout(resolve, 500 * animationSpeed));

            // 5. Pan and zoom to sidebar
            const sidebarRect = document.querySelector('.mock-sidebar').getBoundingClientRect();
            const currentContainerRect = trailerContainer.getBoundingClientRect();
            const targetScale = 1.2; // Zoom in
            const targetTranslateX = -((sidebarRect.left + sidebarRect.width / 2) - (currentContainerRect.width / 2)) * targetScale;
            const targetTranslateY = -((sidebarRect.top + sidebarRect.height / 2) - (currentContainerRect.height / 2)) * targetScale;

            await setCamera(targetScale, targetTranslateX, targetTranslateY, 1500 * animationSpeed);
            setCursorPos(sidebarItems[0]); // Move cursor to first sidebar item
            await new Promise(resolve => setTimeout(resolve, 500 * animationSpeed));

            // 6. Hover over sidebar items
            for (const item of sidebarItems) {
                await moveCursorTo(item, 300 * animationSpeed);
                item.classList.add('hovered'); // Simulate hover
                await new Promise(resolve => setTimeout(resolve, 200 * animationSpeed));
                item.classList.remove('hovered');
            }

            // 7. Select Personalization
            await moveCursorTo(personalizationSidebarItem, 500 * animationSpeed);
            personalizationSidebarItem.classList.add('selected'); // Simulate selected state
            await new Promise(resolve => setTimeout(resolve, 1000 * animationSpeed));

            // 8. Pan out and move cursor to theme selector
            const themeSelectorRect = themeSelector.getBoundingClientRect();
            const containerRect = trailerContainer.getBoundingClientRect();
            const finalTargetScale = 1; // Back to original zoom
            const finalTranslateX = -((themeSelectorRect.left + themeSelectorRect.width / 2) - (containerRect.width / 2)) * finalTargetScale;
            const finalTranslateY = -((themeSelectorRect.top + themeSelectorRect.height / 2) - (containerRect.height / 2)) * finalTargetScale;

            await setCamera(finalTargetScale, finalTranslateX, finalTranslateY, 1500 * animationSpeed);
            themeSelector.classList.add('active'); // Show theme selector
            setCursorPos(themeOptions[0]); // Move cursor to first theme option
            await new Promise(resolve => setTimeout(resolve, 1000 * animationSpeed));

            // 9. Select a theme
            await moveCursorTo(themeOptions[1], 500 * animationSpeed); // Select light theme
            themeOptions[1].style.backgroundColor = '#333'; // Simulate hover/click
            await new Promise(resolve => setTimeout(resolve, 300 * animationSpeed));

            // 10. Cut to black and show final text
            trailerContainer.style.opacity = 0; // Fade out content
            finalScreen.style.opacity = 1;
            await new Promise(resolve => setTimeout(resolve, 500 * animationSpeed));

            finalText1.style.opacity = 1;
            finalText1.style.transform = 'translateY(0)';
            await new Promise(resolve => setTimeout(resolve, 1500 * animationSpeed));

            finalText2.style.opacity = 1;
            finalText2.style.transform = 'translateY(0)';
        }

        window.onload = startTrailer;
    </script>
</body>
</html>